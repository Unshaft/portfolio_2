---
// pages/contact.astro
import BaseLayout from '../../layouts/BaseLayout.astro';

const FORMSPREE_ID = "meeeoynr";
---

<BaseLayout lang="fr" altLangHref="/en/contact" title="Contact - Killian Perzo" description="Contactez-moi pour discuter de vos projets data, collaborations ou opportunités.">
  <section class="max-w-xl mx-auto py-8 sm:py-16 px-4 sm:px-0">
    <h1 class="text-2xl sm:text-4xl font-bold text-charcoal dark:text-white mb-3 sm:mb-4">Me contacter</h1>
    <p class="text-gray-700 dark:text-gray-300 mb-4 sm:mb-6 text-sm sm:text-base">
      Envie de discuter d'un projet, d'une collaboration ou simplement échanger ? Contactez-moi ci-dessous.
    </p>

    <form
      action={`https://formspree.io/f/${FORMSPREE_ID}`}
      method="POST"
      class="space-y-4"
      id="contact-form"
    >
      <div>
        <label for="name" class="block text-sm font-medium text-charcoal dark:text-gray-200 mb-1">Nom</label>
        <input
          type="text"
          name="name"
          id="name"
          placeholder="Votre nom"
          required
          autocomplete="name"
          class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white px-3 sm:px-4 py-2.5 sm:py-2 rounded-lg focus:ring-2 focus:ring-gold focus:border-transparent transition text-base"
        />
      </div>

      <div>
        <label for="email" class="block text-sm font-medium text-charcoal dark:text-gray-200 mb-1">Email</label>
        <input
          type="email"
          name="email"
          id="email"
          placeholder="Votre email"
          required
          autocomplete="email"
          class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white px-3 sm:px-4 py-2.5 sm:py-2 rounded-lg focus:ring-2 focus:ring-gold focus:border-transparent transition text-base"
        />
      </div>

      <div>
        <label for="message" class="block text-sm font-medium text-charcoal dark:text-gray-200 mb-1">Message</label>
        <textarea
          name="message"
          id="message"
          placeholder="Votre message"
          rows="5"
          required
          class="w-full border border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white px-3 sm:px-4 py-2.5 sm:py-2 rounded-lg focus:ring-2 focus:ring-gold focus:border-transparent transition text-base resize-none"
        ></textarea>
      </div>

      <!-- Honeypot anti-spam -->
      <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off" />

      <button
        type="submit"
        class="w-full sm:w-auto bg-charcoal dark:bg-gold text-white px-6 py-3 sm:py-2 rounded-lg hover:bg-gold dark:hover:bg-oldgold transition-colors duration-300 font-medium text-base active:scale-95"
      >
        Envoyer
      </button>
    </form>

    <!-- Message de succès (affiché si redirection avec ?success) -->
    <div id="success-message" class="hidden mt-6 p-4 bg-green-100 dark:bg-green-900 border border-green-400 dark:border-green-600 text-green-700 dark:text-green-300 rounded-lg text-sm sm:text-base">
      Merci pour votre message ! Je vous répondrai dans les plus brefs délais.
    </div>
  </section>

  <script>
    // Afficher le message de succès si présent dans l'URL
    if (window.location.search.includes('success')) {
      document.getElementById('success-message')?.classList.remove('hidden');
      document.getElementById('contact-form')?.classList.add('hidden');
    }
  </script>
</BaseLayout>
