---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import DotNavigation from '../../components/DotNavigation.jsx';
import { getCategoryStyle } from '../../lib/constants';

const allProjects = await getCollection('projects');
const projects = allProjects
  .filter(p => p.data.locale === 'fr')
  .sort((a, b) => (a.data.order ?? 99) - (b.data.order ?? 99));
---

<BaseLayout
  lang="fr"
  altLangHref="/en"
  title="Killian Perzo - Data Scientist | IA Agentique"
  description="Portfolio de Killian Perzo, Data Scientist spÃ©cialisÃ© en IA agentique. DÃ©couvrez mes projets en LangChain, LangGraph, agents autonomes et systÃ¨mes multi-agents. CrÃ©ateur de DataSentinel AI et DataBad."
  scrollMode="snap"
>
  <DotNavigation client:only="react" />

  <!-- Section 1 : Welcome -->
  <section id="welcome" class="min-h-full snap-start flex flex-col justify-center items-center px-4 sm:px-6 py-12 sm:py-20 bg-slate-50 dark:bg-gray-800" data-aos="fade-up">
    <h1 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-3 sm:mb-4 text-charcoal dark:text-white text-center leading-tight">Bienvenue sur mon portfolio ğŸ‘‹</h1>
    <p class="text-base sm:text-lg text-center max-w-2xl text-gray-700 dark:text-gray-300 px-2">Je suis Killian, Data Scientist spÃ©cialisÃ© en <strong class="text-charcoal dark:text-gold">IA agentique</strong> & crÃ©ateur d'agents autonomes intelligents.</p>
    <a href="#projects" class="mt-6 sm:mt-8 bg-gold hover:bg-oldgold text-white px-5 sm:px-6 py-2.5 sm:py-3 rounded text-sm sm:text-base transition-colors active:scale-95">ğŸš€ Voir mes projets</a>
  </section>

  <!-- Section 2 : Projects -->
  <section id="projects" class="min-h-full snap-start flex flex-col justify-center items-center px-4 sm:px-6 py-12 sm:py-20 bg-slate-100 dark:bg-gray-900" data-aos="fade-up">
    <h2 class="text-2xl sm:text-3xl font-bold mb-4 sm:mb-6 text-charcoal dark:text-white text-center">ğŸ“Œ Projets rÃ©cents</h2>
    <ul class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 w-full max-w-4xl">
      {projects.slice(0, 2).map(project => {
        const category = getCategoryStyle(project.data.category, 'fr');
        return (
          <li class="bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden transition hover:shadow-xl active:scale-[0.98]">
            <a href={`/fr/projects/${project.slug}`} class="block p-4 sm:p-6 space-y-2 sm:space-y-3 h-full">
              <div class="flex items-start sm:items-center justify-between gap-2">
                <h3 class="font-semibold text-base sm:text-lg text-charcoal dark:text-white group-hover:text-gold transition flex-1">
                  {project.data.title}
                </h3>
                {category && (
                  <span class={`text-xs font-medium px-2 py-1 rounded-full shrink-0 ${category.classes}`}>
                    {category.label}
                  </span>
                )}
              </div>
              <p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-3">{project.data.description}</p>
            </a>
          </li>
        );
      })}
    </ul>
  </section>

  <!-- Section 3 : Skills -->
  <section id="skills" class="min-h-full snap-start flex flex-col justify-center items-center px-4 sm:px-6 py-12 sm:py-20 bg-slate-50 dark:bg-gray-800" data-aos="fade-up">
    <h2 class="text-xl sm:text-2xl font-semibold text-charcoal dark:text-white mb-4 sm:mb-6 flex items-center gap-2">
      <span class="text-pink-600 text-lg sm:text-xl">ğŸ’¼</span> CompÃ©tences clÃ©s
    </h2>
    <div class="grid grid-cols-3 sm:flex sm:flex-wrap justify-center gap-2 sm:gap-4 w-full max-w-lg sm:max-w-none">
      {[{ name: 'Python', logo: '/icons/Python.svg' }, { name: 'LangChain', logo: '/icons/Python.svg' }, { name: 'LangGraph', logo: '/icons/Python.svg' }, { name: 'FastAPI', logo: '/icons/Jira.svg' }, { name: 'ChromaDB', logo: '/icons/MongoDB.svg' }, { name: 'Claude AI', logo: '/icons/Astro.svg' }]
      .map(skill => (
        <div class="flex flex-col items-center justify-center p-2 sm:p-4 gap-1 sm:gap-2 rounded-lg sm:rounded-xl bg-white/70 dark:bg-gray-700/70 shadow hover:shadow-md transition text-center sm:min-w-[120px]">
          <img src={skill.logo} alt={skill.name} class="h-6 w-6 sm:h-8 sm:w-8 object-contain dark:invert dark:brightness-200" loading="lazy" />
          <span class="text-xs sm:text-sm font-semibold text-charcoal dark:text-gray-200">{skill.name}</span>
        </div>
      ))}
    </div>
  </section>
</BaseLayout>
